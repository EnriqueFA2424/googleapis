// Copyright 2024 Google LLC
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

syntax = "proto3";

package google.cloud.dataqna.v1alpha1;

import "google/api/field_behavior.proto";
import "google/cloud/dataqna/v1alpha1/credentials.proto";

option go_package = "cloud.google.com/go/dataqna/apiv1alpha1/dataqnapb;dataqnapb";
option java_multiple_files = true;
option java_outer_classname = "DatasourceProto";
option java_package = "com.google.cloud.dataqna.v1alpha1";

// A collection of references to datasources.
message DatasourceReferences {
  // The datasources to use.
  oneof references {
    // References to BigQuery tables.
    BigQueryTableReferences bq = 1;

    // References to Looker explores.
    LookerExploreReferences looker = 3;
  }
}

// Message representing references to BigQuery tables.
message BigQueryTableReferences {
  // Required. References to BigQuery tables.
  repeated BigQueryTableReference table_references = 1
      [(google.api.field_behavior) = REQUIRED];
}

// Message representing a reference to a single BigQuery table.
message BigQueryTableReference {
  // Required. The project the table belongs to.
  string project_id = 1 [(google.api.field_behavior) = REQUIRED];

  // Required. The dataset the table belongs to.
  string dataset_id = 3 [(google.api.field_behavior) = REQUIRED];

  // Required. The table id.
  string table_id = 4 [(google.api.field_behavior) = REQUIRED];
}

// Message representing references to Looker explores.
message LookerExploreReferences {
  // Required. References to Looker explores.
  repeated LookerExploreReference explore_references = 1
      [(google.api.field_behavior) = REQUIRED];

  // Required. The credentials to use when calling the Looker API.
  Credentials credentials = 2 [(google.api.field_behavior) = REQUIRED];
}

// Message representing a reference to a single Looker explore.
message LookerExploreReference {
  // The base url of the Looker instance.
  string looker_instance_uri = 1;

  // Required. Looker Model as outlined in
  // https://cloud.google.com/looker/docs/lookml-terms-and-concepts#major_lookml_structures
  // Name of LookML model.
  string lookml_model = 4 [(google.api.field_behavior) = REQUIRED];

  // Required. Looker Explore as outlined in
  // https://cloud.google.com/looker/docs/lookml-terms-and-concepts#major_lookml_structures
  // Name of LookML explore.
  string explore = 5 [(google.api.field_behavior) = REQUIRED];
}

// A datasource that can be used to answer questions.
message Datasource {
  // The reference to the datasource.
  oneof reference {
    // A reference to a BigQuery table.
    BigQueryTableReference bigquery_table_reference = 1;

    // A reference to a Looker explore.
    LookerExploreReference looker_explore_reference = 4;
  }

  // Output only. The schema of the datasource.
  Schema schema = 3 [(google.api.field_behavior) = OUTPUT_ONLY];
}

// The schema of a Datasource or QueryResult instance.
message Schema {
  // Output only. The fields in the schema.
  repeated Field fields = 1 [(google.api.field_behavior) = OUTPUT_ONLY];
}

// A field in a schema.
message Field {
  // Output only. The name of the field.
  string name = 1 [(google.api.field_behavior) = OUTPUT_ONLY];

  // Output only. The type of the field.
  string type = 2 [(google.api.field_behavior) = OUTPUT_ONLY];

  // Output only. A brief description of the field.
  string description = 3 [(google.api.field_behavior) = OUTPUT_ONLY];

  // Output only. The mode of the field (e.g., NULLABLE, REPEATED).
  string mode = 4 [(google.api.field_behavior) = OUTPUT_ONLY];
}
